// Generated by CoffeeScript 1.3.3
(function() {
  var CMinion, Minion, director, http, port, router, server;

  http = require("http");

  director = require("director");

  CMinion = require("../../minion");

  Minion = new CMinion();

  router = new director.http.Router();

  server = http.createServer(function(req, res) {
    req.chunks = [];
    req.on('data', function(chunk) {
      return req.chunks.push(chunk.toString());
    });
    return router.dispatch(req, res, function(err) {
      if (err) {
        res.writeHead(404);
        return res.end;
      }
    });
  });

  router.post('/', function() {
    this.res.writeHead(200, {
      "Content-Type": "text/plain"
    });
    this.res.end(this.req.headers["content-length"]);
    return Minion.logRequest(this.req, true);
  });

  Minion.started();

  port = process.env.PORT || 3000;

  server.listen(port);

}).call(this);
